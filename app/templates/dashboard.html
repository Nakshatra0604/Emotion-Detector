<!DOCTYPE html>
<html>
<head>
    <title>Emotion Dashboard</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body>
    <h2>Emotion Dashboard</h2>
    <canvas id="emotionChart" width="600" height="400"></canvas>
    <script>
        const rawData = {{ data|tojson }};
        let counts = {};

        rawData.forEach(row => {
            let key = row.name + " - " + row.emotion;
            counts[key] = (counts[key] || 0) + 1;
        });

        const labels = Object.keys(counts);
        const values = Object.values(counts);

        //  Generate random colors for each bar
        const colors = labels.map(() => {
            return "hsl(" + Math.floor(Math.random() * 360) + ", 70%, 60%)";
        });

        new Chart(document.getElementById("emotionChart"), {
            type: 'bar',
            data: {
                labels: labels,
                datasets: [{
                    label: "Emotion Count",
                    data: values,
                    backgroundColor: colors
                }]
            },
            options: {
                responsive: true,
                plugins: {
                    legend: { display: false }
                }
            }
        });
    </script>
</body>
</html>
